<!--
  ~ Copyright 2013-2024, Seqera Labs
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<html>
<head>
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
</head>
<body>
<pre class="mermaid" style="text-align: center;">
flowchart TB
    subgraph " "
    v5["samplesheet"]
    v10["Channel.from"]
    v23["ch_genome"]
    v40["adapter_fasta"]
    v41["discard_trimmed_pass"]
    v42["save_trimmed_fail"]
    v43["save_merged"]
    v53["adapter_fasta"]
    v54["save_trimmed_fail"]
    v55["save_merged"]
    v75["bam_format"]
    v76["cigar_paf_format"]
    v77["cigar_bam"]
    v85["bam_format"]
    v86["cigar_paf_format"]
    v87["cigar_bam"]
    v96["ch_gff"]
    v125["ch_fasta"]
    v142["save_cliprejects"]
    v143["save_clipstats"]
    v158["fasta"]
    v175["save_mpileup"]
    v203["Channel.fromPath"]
    v206["ch_workflow_summary"]
    v209["ch_methods_description"]
    v232["ch_fasta"]
    v235["db_name"]
    v248["Channel.fromPath"]
    v251["ch_workflow_summary"]
    v254["ch_methods_description"]
    end
    subgraph AQUASCOPE
    subgraph runQualityAlign
    v6([SAMPLESHEET_CHECK])
    v24([SAMTOOLS_FAIDX])
    v28([FASTQC_RAW_SHORT])
    v32([NANOPLOT_RAW_LONG])
    v44([FASTP_SHORT])
    v56([FASTP_LONG])
    v64([FASTQC_SHORT_TRIMMED])
    v67([NANOPLOT_LONG_TRIMMED])
    v78([MINIMAP2_ALIGN_SHORT])
    v88([MINIMAP2_ALIGN_LONG])
    v97([REHEADER_BAM])
    v102([QUALIMAP_BAMQC])
    subgraph IVAR_TRIMMING_SORTING
    v112([IVAR_TRIM])
    subgraph BAM_SORT_STATS_SAMTOOLS
    v116([SAMTOOLS_SORT])
    v119([SAMTOOLS_INDEX])
    v126([SAMTOOLS_STATS])
    v128([SAMTOOLS_FLAGSTAT])
    v131([SAMTOOLS_IDXSTATS])
    v122(( ))
    end
    end
    subgraph ONT_TRIMMING
    v144([SAMTOOLS_AMPLICONCLIP])
    subgraph BAM_SORT_STATS_SAMTOOLS
    v149([SAMTOOLS_SORT])
    v152([SAMTOOLS_INDEX])
    v159([SAMTOOLS_STATS])
    v162([SAMTOOLS_FLAGSTAT])
    v165([SAMTOOLS_IDXSTATS])
    v155(( ))
    end
    end
    v176([IVAR_VARIANTS])
    v216([MULTIQC])
    v11(( ))
    v26(( ))
    v49(( ))
    v61(( ))
    v101(( ))
    v171(( ))
    v185(( ))
    v213(( ))
    v214(( ))
    v215(( ))
    v220(( ))
    end
    subgraph runFreyja
    subgraph FREYJA_VARIANT_CALLING
    v233([FREYJA_VARIANTS])
    v236([FREYJA_UPDATE])
    v239([FREYJA_DEMIX])
    v234(( ))
    end
    v261([MULTIQC])
    v258(( ))
    v259(( ))
    v260(( ))
    v265(( ))
    end
    end
    subgraph " "
    v7[" "]
    v8[" "]
    v9[" "]
    v22[" "]
    v25[" "]
    v29[" "]
    v33[" "]
    v34[" "]
    v35[" "]
    v36[" "]
    v45[" "]
    v46[" "]
    v47[" "]
    v48[" "]
    v57[" "]
    v58[" "]
    v59[" "]
    v60[" "]
    v65[" "]
    v66[" "]
    v68[" "]
    v69[" "]
    v70[" "]
    v71[" "]
    v72[" "]
    v79["ch_short_align_bai"]
    v80[" "]
    v89[" "]
    v90["ch_long_align_bai"]
    v91[" "]
    v98["ch_rehead_sorted_bai"]
    v113["ch_ivar_sort_log"]
    v117[" "]
    v120[" "]
    v129["flagstat"]
    v132["idxstats"]
    v145[" "]
    v146[" "]
    v150[" "]
    v153[" "]
    v160["stats"]
    v163["flagstat"]
    v166["idxstats"]
    v177[" "]
    v178["ch_ivar_vcf"]
    v181["ch_versions"]
    v217[" "]
    v218[" "]
    v219[" "]
    v221["multiqc_report"]
    v237[" "]
    v242["ch_versions"]
    v262[" "]
    v263[" "]
    v264[" "]
    v266["multiqc_report"]
    end
    v5 --> v6
    v6 --> v9
    v6 --> v8
    v6 --> v7
    v10 --> v11
    v11 --> v22
    v23 --> v24
    v23 --> v78
    v23 --> v88
    v23 --> v176
    v24 --> v176
    v24 --> v25
    v24 --> v26
    v11 --> v28
    v28 --> v29
    v28 --> v26
    v28 --> v185
    v11 --> v32
    v32 --> v36
    v32 --> v35
    v32 --> v34
    v32 --> v33
    v32 --> v26
    v40 --> v44
    v41 --> v44
    v42 --> v44
    v43 --> v44
    v11 --> v44
    v44 --> v48
    v44 --> v47
    v44 --> v46
    v44 --> v45
    v44 --> v26
    v44 --> v49
    v44 --> v185
    v53 --> v56
    v54 --> v56
    v55 --> v56
    v11 --> v56
    v56 --> v60
    v56 --> v59
    v56 --> v58
    v56 --> v57
    v56 --> v26
    v56 --> v61
    v56 --> v185
    v49 --> v64
    v64 --> v66
    v64 --> v65
    v64 --> v185
    v61 --> v67
    v67 --> v72
    v67 --> v71
    v67 --> v70
    v67 --> v69
    v67 --> v68
    v75 --> v78
    v76 --> v78
    v77 --> v78
    v49 --> v78
    v78 --> v80
    v78 --> v79
    v78 --> v112
    v78 --> v26
    v78 --> v101
    v85 --> v88
    v86 --> v88
    v87 --> v88
    v61 --> v88
    v88 --> v91
    v88 --> v90
    v88 --> v89
    v88 --> v144
    v88 --> v101
    v96 --> v97
    v96 --> v102
    v96 --> v176
    v11 --> v97
    v97 --> v98
    v97 --> v26
    v97 --> v101
    v97 --> v171
    v101 --> v102
    v102 --> v26
    v102 --> v185
    v112 --> v116
    v112 --> v113
    v112 --> v26
    v116 --> v119
    v116 --> v117
    v116 --> v26
    v116 --> v122
    v116 --> v171
    v119 --> v120
    v119 --> v26
    v119 --> v122
    v125 --> v126
    v122 --> v126
    v126 --> v26
    v126 --> v185
    v122 --> v128
    v128 --> v129
    v128 --> v26
    v122 --> v131
    v131 --> v132
    v131 --> v26
    v142 --> v144
    v143 --> v144
    v144 --> v149
    v144 --> v146
    v144 --> v145
    v144 --> v26
    v149 --> v152
    v149 --> v150
    v149 --> v26
    v149 --> v155
    v149 --> v171
    v152 --> v153
    v152 --> v26
    v152 --> v155
    v158 --> v159
    v155 --> v159
    v159 --> v160
    v159 --> v26
    v155 --> v162
    v162 --> v163
    v162 --> v26
    v155 --> v165
    v165 --> v166
    v165 --> v26
    v175 --> v176
    v171 --> v176
    v176 --> v178
    v176 --> v177
    v176 --> v26
    v26 --> v181
    v203 --> v213
    v206 --> v185
    v209 --> v185
    v185 --> v216
    v213 --> v216
    v214 --> v216
    v215 --> v216
    v216 --> v219
    v216 --> v218
    v216 --> v217
    v216 --> v220
    v220 --> v221
    v232 --> v233
    v171 --> v233
    v233 --> v239
    v233 --> v234
    v235 --> v236
    v236 --> v239
    v236 --> v237
    v236 --> v234
    v239 --> v185
    v239 --> v234
    v234 --> v242
    v248 --> v258
    v251 --> v185
    v254 --> v185
    v185 --> v261
    v258 --> v261
    v259 --> v261
    v260 --> v261
    v261 --> v264
    v261 --> v263
    v261 --> v262
    v261 --> v265
    v265 --> v266

</pre>
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>
</body>
</html>
